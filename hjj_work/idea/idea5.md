# 生活玩法相关设定和系统

## 记忆系统

（很难做）
过剧情遇到重要事件时字体高亮，玩家手动点击之后把相关信息存到“脑海”
脑海只允许存几个事件，容量由事件加入时间和相关技能决定
新事件会顶掉最老的事件
在安全的时候，手动进行“记录”操作，就可以把相关信息存到日记或者教程里
记忆的事件越久，印象越淡
这个系统结合图鉴和战斗
给战斗新增“谨慎战斗”姿态，这时可以获得敌人的属性相关信息，比如属于动物植物，弱远程弱近战，
设定刷怪场所和村庄安全区域有距离，需要时间过去回来，这样战斗时只能战斗，记下的敌人信息就存入脑海，需要等到回村才能入图鉴
敌人有各种属性，通过这种方式由玩家发现，再设计针对各种弱点属性的装备，设计各种技能
玩家时常记忆，就可以设定感觉很敏锐，允许在生活技能里获得加成

## 伐木系统

一种生活行为，
主要产出成品木头，新鲜木屑
次要产出鸟巢，果实，树皮，种子
次要产出是有一部分树能产出的

基本逻辑是树有血量，用伐木力去攻击，根据击杀时间的档次获得产物数量
比如 0-1 秒就打完，给与最高档次奖励，5 个木头，少量新鲜木屑
比如 1-5 秒打完，给与第二档次奖励，3 个木头，较多新鲜木屑
比如 5-10 秒打完，给与第三档次奖励，1 个木头，许多新鲜木屑
比如 10 秒以上打完，就像是把树砍了个细碎，已经不是砍树而是破坏了
给与第四档次奖励，0 个木头，大量新鲜木屑，

次要产出是只要伐木成功，就会进行一次随机，数量和种类都是随机的

木头是常用的建筑材料，武器材料，木屑是炼金入药的材料
木头和新鲜木屑可以在合成系统里互换，转换效率都很低，
用这种方式让玩家能搞到一点点珍贵的高级木头，
想做就去做，性价比比较低而已，玩家会自己找到喜欢的方式

一个地点会有几种树，这个情报不会直接告诉玩家，
正常来说，玩家发现某个地点可以伐木，开始伐木之后知道这里大概有那么几种树，之后如果想要某种特定的木头，可能就会尝试刷
要不要允许玩家刷新呢
如果不允许玩家刷新，那么在一个地点刷新出来的树，就要一直保留
玩家离开了这个地方再回来，也还是这棵树，玩家去到其他伐木地点，另一个地点刷了树，回到这里也还是这颗树

如果允许玩家刷新，那干脆就方便到底，直接给一个更换目标按钮，让玩家手动玩的时候想砍哪个就砍哪个
地点随机刷新树的时候依旧随机

两个方案最不可兼顾的是随机刷新树时要不要安排稀有树
如果不可刷新，那玩家想要稀有树就得硬砍
如果可以刷新，那这个稀有树就得安排有限数量机制，不能随便给玩家刷出来砍到

作为玩家，应该是希望能刷新比较好的，就按照可以刷新的方案做吧

## 采集系统

产出主要资源，稀有资源，特殊资源
根据进行采集的地点不同，各个资源也不一样
主要资源当然就是根据当前具体地图获得的资源

稀有资源基本上就是当前采集的主要资源的高级版本，或者打包版本
高级版本会内置 cd，相当于保底机制，根据次数和时间来保底给玩家
打包版本其实就是高效获取主要资源的方式，相当于宝箱

特殊资源是许多地图都通用的
比如在森林相关的区域，都能收集到木属性
在地下相关的区域能收集到土和金属性
或者一些重要一次性物品，只能在某个地图拿到的，就都归类到特殊里

采集的基本逻辑是
每次采集的时间根据资源决定
玩家的采集力和当前地点规定的资源的防御力进行计算
仿照战斗时精准和闪避的计算
算出一个成功率，成功率超过 100%的部分就变成概率获得第二个，以此类推
一次采集就根据这个成功率给予资源
有最小概率和最大概率的限制，最小不会小到 0，起码留个 5%吧，最大不会超过当前地点设定的资源数量的一半

这样玩家在低采集力的时候，就是概率获得资源
或者强行采集，主要资源拿不到也能获得当地的特殊资源

采集力高了，主要资源能一次给两三个
虽然主要资源充裕了，但是玩家这时候想要的是稀有资源
多给也相当于变相提高了稀有率，
何况还有稀有资源项目里的保底机制

## 挖矿系统

产出主要资源，稀有资源，特殊资源

基本逻辑类似伐木，但是挖矿的资源带有防御力
挖矿力先被资源的防御力削减，剩余部分打到资源生命上
不设置时间档次，设置矿物稀有度和血量
如果玩家挖到的是普通的资源，那挖完之后给予大量主要，
如果挖到的是稀有的资源，挖完给少量主要，少量稀有
如果挖到的是特殊资源，挖完不给主要，给特殊
根据矿物的血量比例来给予资源的具体数量，

挖矿里，上述的稀有度不会直接展示给玩家，血量可以展示
资源的防御力也不是固定的，
普通矿石防御力正常，稀有矿石防御力高，特殊矿石防御力低
因为防御力的存在，矿石资源就带有门槛了，
强行挖矿会毫无收获，要设定的小心一点

矿石分为很多种类
简单的版本就是刚刚提到的带防御力的矿石
有些可以把防御力设置的很高，血量设置的很低，
这样就要么击破，要么挖不动
有些是珍贵的东西，一击只能扣最大血量的 10%，这样就需要专门的工具来处理
例如考古挖掘什么的

## 钓鱼系统

基本逻辑有两步
首先是上钩阶段，玩家的上钩力和环境的上钩阈值进行对抗
环境有两个上钩阈值，一个是及格阈值，一个是满阈值
当玩家的上钩力低于及格阈值时，就完全钓不到任何鱼，不会上钩
当玩家上钩力介于及格阈值和满阈值之间，就可以开始计算概率，
如果失败，则玩家的上钩力临时增加一层再进行计算
不断反复，直到上钩成功
当玩家上钩力大于满阈值时，直接就上钩
及格阈值一般情况都是 0，只在特殊的鱼塘里加
这样设计之后，玩家就算强行钓鱼，也能花费很长的时间成功上钩
后期属性高了就直接中
整体是一个拖时间的机制

上钩成功之后进入遛鱼阶段，
玩家的遛鱼力和鱼的逃跑力进行对抗，直接相减，每次对抗完鱼的逃跑力降低，可以逐渐减到 0
每次对抗的结果直接加到鱼的生命上，正负都加
鱼的生命会乘以上钩阶段花费的时间

这样玩家只要进行钓鱼，花费足够的耐心，大部分时候都能上钩
上钩之后只要足够耐心，最终都能把鱼钓上来

钓鱼能得到主要资源和特殊资源
特殊资源就是宝箱和垃圾，这些资源就不设置逃跑力了

## 时间设定

现实 1 秒游戏内 1 分钟
也就是现实中 6 天等于游戏内一年，可以做一个基本的循环
大部分事件需要触发时间间隔的，一般安排到下一年才触发
而且这类事件要有较高的触发机会，不希望设计出来的事件因为时间限制而浪费，让玩家干瞪眼
少设计需要跨年的事件，主要是玩家记不住有这事，玩家会有自己的安排，事件到了非要停下是不好的

## 旅行系统

每个大安全区之间有两个途径相互移动
一个是走传送门
另一个是旅行

传送门可以花费低级资源和跳过时间来到达目的地
第二章结束时首次离开村子就这么规定

设定安全区野外神鬼莫测（关闭存档机制）
所以自己野外旅行时就要做好死在外面的心理准备（出门到死亡这个过程回档）
反正死亡就是回到上一个自动存档，也不用写新功能
有些技能在这种比较危险的区域也很正常吧
设定在出门的时候自动存档，出门之后玩家死了就从这个自动存档复活

要么攒够资源通过传送门便捷安全旅行，要么自己耗费这些资源和时间旅行

第三章就是开辟新传送门的过程
开新地图的挂机就是，旅行到目的地，打掉一定数量的怪，消耗资源建造传送门，旅行回家补给
平常副本挂机是，旅行到目的地，打一定数量的怪（直到限制条件），旅行回家补给
开荒就是多了消耗资源造传送门这一步，旅行回家可以设定有回城魔法
整体过程没有大改
开荒完毕之后目的地就变成一个“战斗前线”
和村庄的野外副本的前线类似，都可以在战斗之后临时休息
统一了

## 烹饪系统

初期玩家刷到的恢复物品基本是各种水果，蔬菜，肉类
直接获得的原料，直接生吃效果不佳，比如只给予少量短时间的每秒恢复，不给立刻恢复
肉类直接吃还会有 debuff
初步烹饪成熟之后，无论是直接烤，还是和其他食材做成菜，总之经过了烹饪之后，效果都会更好，
具体效果是简单的将原料的 buff 叠在一起，去掉 debuff，然后额外增加一个立刻恢复的数值

当度过了前期，后面当然会有更强的食材，更好的菜品，或者简单粗暴的丹药药水等
但是前面的垃圾食材不能就这么浪费了

每种食材都设定“煮熟”，“制成干制品”，“浓缩成酱”
煮熟就是最开始提到的烹饪，只消耗单种食材也好，消耗几种食材一起做成菜也好

制成干制品是将单种食材多个做一个，果干，蔬菜干，肉干
干制品视作烹饪后的成品菜，会去掉 debuff，额外给予立刻恢复的数值，但是考虑不再给持续恢复
干制品主要是增加堆叠数量，虽然只用到了单个食材，立刻恢复的数值不如菜品回的多，还少了持续恢复
但是好在堆得多，可以近似视作一种简单的药水

浓缩成酱料是消耗大量的单种食材，最后给与一个新的食材，主要想法是做菜时使用
给最终菜品额外加酱料食材的每秒恢复，多种酱料的每秒恢复累加
（最终菜品会有很多额外的变量，在代码上比较难设计，
而且对玩家的背包堆叠很不友好，毕竟属性不同的物品会单独开一个格子，就相当于多了一个负重
如果能实现，在玩法上就很好）

只给成品菜的加成乘一个倍数，这个倍数基于酱料的原料的等级
（这样程序实现比较简单，但是酱料的用处就会变低，而且多种酱料就不好叠加了）

给成品菜加一个“完美”的设定，完美的菜品属性更高，直接制作时完美概率比较低，
额外添加酱料能提高完美概率，加的越多概率越高
（这个设计比较敷衍，实现简单，酱料固然有用，但是比较廉价，而且也很容易被后期的高级酱料代替）

选用第一种方案，给烹饪额外新增一个“混合菜品”功能
设定为玩家灵机一动，菜品无非都是食材烹饪得到的，为什么要分得那么细致，混在一起不行吗
具体效果就是将玩家目前所有同 id 的菜品的所有属性累加然后平分，
如果对菜品的分类做的比较好，可以将所有正常烹饪获得的菜品都均分属性

## 药材、炼丹、药浴相关设定

相对于食材，烹饪，菜品这一套系统
药材，炼丹，丹药这一套系统就应该要设计一些不一样的
菜品主要提供基础的红绿蓝资源，无论什么时候都要吃的
丹药初步考虑是提供战斗 buff 或者生活技能 buff，但是怎么想都会陷入传统战斗消耗品的窘境
身上带一堆珍贵消耗品但是不舍得用
尤其是在目前游戏框架以挂机为主要玩法的情况下更严重
于是考虑给丹药 buff 做成永久的，同时只允许激活几种，把这个过程叫做“药浴”
保留传统的消耗品丹药，想用就用吧

针对炼丹中用到的药材，专属于药材的属性是年份
食材可以搞什么珍稀食材，以特殊为主，药材额外多新增一种年份的属性
为了防止后期百年千年灵药堆仓库，设定拿到的药材都不是完整的个体（虽然好像是废话）
而玩家在收获草药的时候，低概率获得完整的，可以种到家里的药材个体（或者换成种子）
这个东西只允许玩家同时拥有一个，在程序上要防止玩家搞丢
这个药材种到家里，供养资源，然后产出药材，养大了以后产出更高年份的药材
实际上就是一个换皮的牧场

## 炼丹设定

炼丹作为消耗材料的生活技能，程序逻辑和其他合成物品的技能是一样的，这不好，我想给它做点不一样的效果
设想是在普通的按配方合成的基础上，新增一种尝试炼丹研究的做法
在这个做法里，每种材料只能投入 1 份，（或许可以多要几个？）
如果投入的材料种类和某种炼丹配方的材料种类一样，就视作研究成功
玩家得到这种炼丹配方，并且得到一个低级版本的炼丹产物

在程序上，就是给每种炼丹配方都额外拷贝一份“炼丹研究配方”，数量都等于 1，种类一致，产物给低级产物
这些炼丹研究配方全部初始解锁，只不过不像正常的配方会展示出来
这样就和正常的合成逻辑一样了

如果玩家投入的资源种类不满足任何配方，那就研究失败，啥都拿不到，或者给点药渣啥的垃圾
又或者在小概率情况下给特别的珍贵的丹药

有这个做法在，就可以往文献剧情里填这个研究配方，然后玩家通过这种方式来获取正常的配方
如果玩家通过攻略已经知道了正常配方，那通过这个研究就可以直接获得
正常的带有社交的游戏，或者有多周目的游戏，我觉得这个研究机制都挺好的，初见或者速通都不错
唯独是对游戏本身有所损害，毕竟按理来说配方是要花费精力获取，或者在某某阶段某某章节才能获取
有这个研究就把这些锁给绕开了

还有个想法是针对低级药品的，设定是将大量低级药品进行萃取，得到药品属性的精华
比如某药的效果是恢复 10 血和 10 蓝，并且获得 10 秒的攻击力加成
那么萃取之后，可以得到恢复 10 血的精华，恢复 10 蓝的精华，和 10 秒攻击力加成的精华
再用这些精华可以炼制成已知的正常药品
比如恢复 100 血的药，就能靠 10 份恢复 10 血的精华来获得
大概意思就是 100 份低级药，经过萃取得到一份高级药
而且由于是经过了低级药-精华-高级药的这个过程，某些带有特别属性的高级药，它们没有对应的精华，也就不能用这个方式获得了

## 货币设定

第一章属于新手教程，没有货币系统

第二章开放村庄内的各个商店，开放野外刷怪，
通过野外刷怪刷副本，获得原材料，或者破损武器等等，出售这些材料，可以获得铜币银币金币
铜银金币的兑换比例设定为 100，但是只给在商店进行兑换，不能自己兑换
结合背包的负重机制，就允许在野外的副本掉钱很多，反正也带不走

第二章的除了花钱在商店买材料买技能书，在制造系统里也允许花钱，
设定钱其实是一种特殊的合金，消耗金钱能提高制造产出高品质武器的概率

第三章开放村庄到前线城市，钱币虽然依旧有效，可以买材料买技能，但是需求量会多一些，
相比于第二章，钱币在第三章的购买力会下降，性价比变低，而且买不到很重要的东西
第三章推出“战功”，随着玩家建造传送门，清理副本，获得城主给的战功，依靠战功购买重要物品
第三章给一个“炼金术”技能，允许玩家将低级钱币合成到高级钱币，解放背包

第四章开放整个王国的领土，第三章中的战功就没用了
第四章中的各个商店和第三章的商店对货币的需求没有质变，正常来说，这时候玩家的钱币会很溢出
结合第四章开放的善恶声望系统，用第四章的善城市和恶组织的善恶门槛来限制玩家花钱
如果善恶不足，那玩家不允许进入善恶区域的商店里买东西，有钱也不给花

第五章进入上界，上界人会掉一种新货币，称为魔力钱币，
这个新钱币用处很多，修炼魔力等级，更高效的制造高品质武器，在上界区域购买物品，
玩家也能生产这种钱币，设定 1w 普通钱币制造 1 个魔力钱币，而且还要消耗魔力

## 雕刻设定

最开始是伐木的变种技能，后来独立成一个新的工艺技能

前期设定是消耗低级的木头石头，花费很长的时间，获得工艺品，然后可以卖钱
雕刻的过程设定成需要一个雕刻间，在满足条件的地点才能雕刻
然后选择一个雕刻方案，投入大量基础资源，生成一个 0 进度的雕刻原胚
然后玩家就开始进去挂机，雕刻过程具体是根据雕刻方案，给玩家 debuff
比如时间加速 30 倍，每秒精力消耗多少多少，没精力时退出雕刻，在这个过程中雕刻的进度会慢慢涨
玩家就进去挂机掉精力，然后没精力了就出来回复，然后再进入雕，反复多次直到雕刻完成
得到雕刻方案的奖励

后期这个技能就可以针对一些稀有宝石，或者把珍贵的材料变成什么什么核心
雕刻过程可以掉血掉蓝，或者给玩家累计某种 debuff 之类的

还有些巧思，就是添加雕刻失败设定，还有雕刻产物随机设定
不过这些设定想出来就觉得不会好玩，就算了

## 锻造设定

为了让玩家不会觉得消耗材料的生活技能都是一个样，明明都一个样却搞了一些莫名其妙的名字和工作台
为了避免挨骂，得给消耗材料的生活技能安排点花样，现在轮到锻造了
但是并没有合适的想法，这里先记录一些其他作品的设定

斗罗大陆中的锻造设定，是需要对矿石进行熔融敲打成锭，不同的矿石按比例敲到一起产生合金
敲矿石是一个技术活，产物有等级，玩家熟练，技能高，那就可以得到高等级的产物
相对应的，最终物品品质就好
我的游戏里，装备确实有稀有度设定，锻造时有概率产出高稀有度的装备这点可以有

我的世界里，锻造分成烧锭和做装备两步，烧锭这个环节是缓慢的、被动的，做装备就是正常合成
缓慢烧锭这事，也不是说不能有，只是如果玩家后期材料多了，有很多种类的矿要处理，却因为缓慢烧矿而时时等着，这就不是很好，而后期的时候让前期的矿秒烧，这就感觉烧矿这事纯纯负面拖节奏，干脆就不该有
如果要有，得合理化，比较难设计

我的世界之什么匠模组，名字忘记了，它有一个大炉子，要烧的金属都能往里放
放完之后自动分流（），然后按需要导出产物，如果控制好里面各种东西的比例，就能导出合金
导出的地方放各种工具的膜具，靠膜具获得具体产物

现实中的锻造，烧锭过程相当的不手工，要烧就烧大量的矿石得到大量的锭，手工操作的部分是从锭开始做的，不好借鉴

目前游戏的物品合成都有配方，锻造里，要给所有锭和所有装备都做配方吗

初步想法是让锻造分两个环节，一个是冶炼矿锭，一个是锻造成品
单一矿石或者材料做成单一锭的配方初始就解锁，合金配方需要拿到
锭做成装备需要拿到配方才能做
给锻造的配方新增燃料机制
烧锭的时候，除了原料，还必须要有燃料，设定为一种燃料，给配方设定燃料值需求，给燃料材料设定燃料值
正常情况下直接消耗燃料直接出产物，如果玩家特意选择了高燃料值的燃料，那制作一次之后剩余燃料值不为 0，就会屯在炉子里，每秒掉 1 点吧，后续烧锭直接用屯的这些就行

锻造成品时也要燃料，和烧锭一样

那分两部分干什么，仅仅给配方简单分个类也可以

那属于锻造的特殊设定就是燃料机制了
要是有技能，可以有概率产出高稀有度的装备

## 生活技能及其变种设定

生活技能，具体是指伐木、钓鱼、挖矿、采集这四种行为
基于玩家当前所处的位置，四个行为有时会锁住不允许执行，有时候允许玩家进行对应技能的变种

伐木技能的变种有：伐木、木雕
钓鱼技能的变种：钓鱼、下水捕捞
挖矿、考古
采集、探索

伐木的变种，木雕，具体是需要玩家使用特殊的木匠工具，消耗木头，挂机一段时间之后，获得木雕作品
设想是让玩家能通过木雕卖钱

下水捕捞是在能钓鱼的地方，穿戴特殊的潜水装备，在水里或捕鱼，或寻找宝物
设想是允许玩家针对性的找特定的鱼或者宝物
毕竟钓鱼的产出比较随机

考古是使用特殊的工具，在挖矿的地点，进行“挖矿”
设想是通过这种方式获得埋在地里的，比较脆弱的物品
毕竟挖矿本身应该不合适产出历史文献，产出文物级别的书籍

探索是使用特殊的工具，在正常采集的地方进行探索，找到比较重要的地点或者物品，记录下来，让之后的采集更有效
毕竟现实中的采集，实际上就是先要探索，探索到了之后才进行的采集

这些变种操作也许就可以直接做成新技能
就决定做成新技能了
伐木，主要产出木材、树皮、叶子、植物果实
钓鱼，产出水产食物、宝箱，垃圾
挖矿，产出石头、矿物、泥土
采集，产出植物，叶子，植物果实，
潜水，产出和钓鱼相同
考古，产出技能书，工艺品
探索，不直接产出物品，而是产出高爆率的地点，在对应地点采集产出更多
耕种（初步设想），消耗种子和资源，产出其他东西

除了上面这些产出型的生活技能，还有消耗资源型的生活技能
原料加工，将自然资源变成人工资源
成品加工，将人造资源变成装备
烹饪，做食物的，食物主要用来回血，
锻造，将自然资源变成人工资源，主要针对矿石资源，没想好要不要做燃料啊暖机啊什么的设定
炼丹，消耗药材，做成提供 buff 的丹药

雕刻，消耗木头石头等比较低级的材料，得到工艺品，工艺品用来卖钱
药浴，消耗炼药的原料，获得永久的 buff
炼金术，垃圾桶合成系统

这么看来，这些消耗资源的生活技能完全没有什么特殊的区分，都是把材料变成产物
药浴是把材料变成 buff，有点不一样
烹饪系统有直接煮熟，“制成干制品”，“浓缩成酱”、烹饪菜品的内部选择，也可以说不一样
雕刻在制作物品的基础上，还会消耗大量的时间，有点点不一样
其他的就真是换了个名字了，这不是很好

## 成就设定

玩家在游戏过程中可以随时随地完成成就，成就的达成可以直接告知玩家，但是成就的奖励却不方便直接给
成就的达成设定上一般是游戏里的重要节点，玩到了就达成了
奖励设定成第四章中的善恶数值和善恶称号，这个奖励直接给了也没什么影响
就是不要给实际的物品和技能

成就在程序实现上有个问题，就是需要可以同时执行
这点和挑战是不一样的，挑战同时只能做一个
成就由于需要同时执行，在程序上就比较难搞了

由于成就的达成条件基本上是两种，累计型和达成型
累计型的像是击杀多少怪，吃了多少东西，拥有多少钱
这种就不需要实时监控，不需要每一帧都循环判定 n 个成就 m 个条件
这种可以让程序每秒执行一次判定逻辑，这些计数都会在程序里存储，所以判定起来也比较容易
这种成就还会有递进的逻辑，100 是一次成就，1000 也是成绩，这都属于同一类，需要兼顾处理

达成型的像是完成了某某事件，有技能达到满级，
这种也不需要实时监控，而是在程序特定位置执行一次判定逻辑即可
完成事件时判定，升级时判定

实际上最难搞的是奇奇怪怪的成就
比如穿着全套装备，这件事看起来简单，程序判定就不容易
首先穿脱装备就不是重要的事件，不会触发事件逻辑
穿脱装备也没有需要统计的数，游戏日志里不会记录
想要判定这个成就，就得在穿衣服时专门为这个成就做个判定逻辑入口
而且这个成就达成之后，判定逻辑就没用了，还得有标记让它关掉
这种成就放到每秒判定里，如果没完成的成就有这个，就检测一遍装备，

如果成就变成“穿全套装备击杀 5 个敌人”
这反而好做，就是在杀敌时判定身上有没有穿好即可

mc 成就之同时获得 10 个 buff，这成就在我这游戏里也放到每秒判定里吧

初步想了一下，成就系统就是提供判定逻辑接口
主循环中每秒调用一次和关键事件节点处调用
在这个接口内部，循环所有未达成的成就，根据成就的条件，获得对应数值，判断成就是否达成
最后的问题就是性能优化，每次都要循环遍历所有未达成的成就，这个有点笨，不知有没有更好的方案

## 挑战设定

挑战是比成就更难达成的，还会有额外的附加条件才能做的，奖励也更丰厚

### 挑战出现条件

挑战就不是随时随地就能做的了
首先挑战出现就有条件，
有些挑战要在特定地点，满足特定条件才能触发，
比如玩家新游戏需要通过“新手战斗训练”的这个挑战，通过了才能解锁村庄内的其他设施，游戏才能进入第二章
这个新手战斗训练，就是要在特定位置（兵营教练 npc 处），满足特定条件（没有做过这个挑战）时才可以开启

这样的设定不够灵活，如果玩家前期就满足出现条件，但是打不过，只能离开，以后忘了这事就错过了
所以有另外的挑战类型，它们是物品，
要么在某些副本里（特定地点），作为最终奖励出现（特定条件，就是稀有掉落），相比于普通挑战，这个物品可以带走
要么作为重要事件的奖励，或者是稀有掉落出现
总之玩家需要满足条件才能做挑战

### 挑战过程

如果是即时开启进入的挑战，当然就是进入之后就启动，
如果是物品类型的挑战，它就是一个消耗品，随时随地可以使用，使用后启动挑战

启动挑战之后，根据挑战的具体内容，接下来玩家就会开始做挑战
有些挑战是要求玩家做到某些事情，比如击败敌人，比如攻击，比如防御，比如割草钓鱼等等
有些挑战是前辈的一段重要事件的记忆，前辈通过这个事件获得了成长，玩家代入到这个前辈身上，做到某些事情
后面这种情况下，既然玩家代入到了前人身上，那属于玩家的加成就不能用了，得换成前人那个时候的状态

程序上，开启挑战之后原地存个档，然后给玩家加上挑战 buff，
负面 buff 就是锁定各种属性技能等等，正面 buff 就是给与玩家前人的状态物品等等
然后把玩家挪到挑战专属的区域里，限制旅行和移动
然后给与一个目标，完成目标就算完成挑战
挑战完成或者失败，都会读档，然后根据完成结果给予物品

### 其他

挑战物品本身或许不一定限定唯一掉落，可以设定这个记忆比较脆弱，玩家进入挑战如果失败了，会有概率破碎
这样就可以多刷多给
完成挑战之后，一般会给予一份奖励，如果想用心设计，那可以给挑战完成预设几个方案
玩家通过 a 方案达成，给予 a 奖励，通过 b 方案达成，给予 b 奖励
就能做出多次刷挑战的效果
一个挑战如果彻底完成了，那挑战物品本身就可以说是没用了，这里给出几个处理方案

1：
设定彻底完成某个挑战之后，对这段记忆足够了解，那就能直接拆解/使用/打开挑战物品，
获得物品，比如记忆碎片，合成材料，
获得经验，挑战本身的奖励是某某技能的情况下，拆解挑战物品就能得到这个技能的经验

2：
设定挑战不止一层，彻底完成之后，可以将多个物品合成进阶，以求找到其中更深的记忆
这样的话，其实就得到了一个新的独立的挑战，做完了也没用了

3：
参与合成，挑战物品既然会有损耗，那就允许将垃圾挑战作为素材，给需要的挑战物品“回血”

4：好像都不冲突，可以全都要

挑战物品的名称设定
梦境
记忆片段
？？
直接抄《蛊真人》的梦境算了

除了前人的梦境，玩家自己也可以有梦境
觉醒前世记忆，这一世我要拿回所有什么的剧情（）
这种挑战就不用把玩家的状态全禁了，可以保留一些
比如游戏进行速度加速十倍的挑战，奖励暂停或者倍速功能
禁止任何装备，只允许佩戴饰品，将玩家拿到过的所有饰品放在背包，要求打过某些 boss，奖励饰品槽
禁止主动攻击，只允许使用防御和辅助相关的主动技能，打过 boss，奖励主动技能槽位
禁止喝药挑战，禁止近战挑战。。。
规划旅行物资，旅行到某地挑战
可以做成一些奇奇怪怪的小游戏，不过最难搞的部分可能的奖励，奖励得是必须有的

## 商店商品设定

一个商店里大约有两种商品，固定商品和随机商品

商品的类型
无限商品，没有什么特别的
无限商品，买到一定程度之后涨价，定时恢复
有限商品，没有什么特别的，不补货
有限商品，买到一定程度之后涨价，定时恢复价格，定时补货
有限商品，定时补货
有限商品，特定事件补货

随机商品是从数据库中随机选择出来，种类确定之后每个商品的具体类型和固定商品没差。

对于城镇里固定点位的商人，基本上就是无限商品，
武器装备等买的比较少的商品设定不涨价，常用材料设定成会涨价的
有些特别珍贵的材料设定成数量有限，一般一周时间刷新一次
基本没有随机商品，也就是说商店里的项目都是固定的，或许有些商品需要解锁，但是种类不变
少数商人可以安排随机商品，数量安排少，

更有变化的设计是在刚刚的基础上，额外在特定时间和特定事件后新增打折活动
商品补货不一定补到满，而是补充随机数量
补货也不一定是增加库存，而是减少库存，假装商品很畅销
除了单买，还可以设计批量打包购买选项，可以便宜一些

野外野生刷新的商店，占比比较多的就是随机商品了
商品类型随机（基本上就是在 1234 里随机），
商品种类随机（根据商人刷新的位置，手工设定当前进度能拿到的物品）
商品单价随机（原价的 50%-500%之间随机，具体算法是）
log(50)大约 1.7，log(500)大约 2.7
随机数取 1.7 到 2.7 之间得到 x，然后用 10^x 得到具体的单价倍率，
结果大约是这样
0% --- 25% -- 50% -- 75% --- 100%
1.7 -- 1.95 -- 2.2 -- 2.45 -- 2.7
50 ---- 89 --- 158 -- 281 --- 500
这样的结果是有一半的商品价格还算正常，有点便宜有点贵，有一半的商品很弱智，超级贵
也就是说可以让这种商店有很多物品
固定点位的带有随机刷新要素的商店，假如只安排 3 个商品允许随机，
那么野外随机商店就可以安排 10 个商品随机，按照概率，里面有 2-3 个是便宜价格的物品，其他的很贵

物品出售时，商人以物品本身价格的 80%收购，且随出售数量增加，物品就越廉价
目前的背包物品因为有装备稀有度和堆叠负重设计，背包能装的东西是有限的，玩家卖很多杂物时要搬很多趟
基于这个情况，商人收购时就允许种类和数量的全收购，什么都能卖，卖的越多越廉价，玩家自己控制卖不卖

但是这个设定其实玩起来不是很爽，有点想改成无限堆叠和无限背包
在无限背包的情况下，商人收购就可以安排种类限制了，商人只收购某些物品，收购时的价格倍率也可以不一样
物品卖给商人之后，会暂时存到商人的库存里变成商品
玩家回购的价格等于商人收购价，这样可以防止玩家不小心卖掉了有用的物品，然后钱不够买不回来的情况
比如某个物品原价 100，玩家卖时以 90 的价格卖出，此时物品在商人的库存里就是 90
如果再卖一个，第二个物品变得廉价，80 卖出，此时物品在商人的库存里就也是 80
玩家出售时的物品，和商人可回购库存里的物品，同一物品要遵守同样的价格算法，防止原地电表倒转
然后商人收购到了物品之后，定时清理这些库存，每次清理一定比例一定数量的库存，防止玩家倒卖太多物品短时间赚大钱
然后重要物品，对于一些游戏唯一的物品，它内部应该得有标识，不允许卖出

## 背包物品设定

目前由于没有物品 ui，每个物品是靠它的名字呈现到背包里的
单个物品在背包里就会占地比较大，现在的滚动条不是很能容纳大量物品
所以设计了物品堆叠上限和负重，让背包里不会同时出现太多的物品
但是这个设计不是很好玩，后面东西多了难道要到处找仓库放吗，合成物品时材料不够要去哪个仓库里找呢

更好的设计是在这个基础上新增物品图标，
同样的界面里可以放下更多的物品了，才好讨论其他机制
在原本设计的基础上把堆叠上限增加，负重增加
这样玩家就可以背着很多种类的东西了，满足外出搜刮一波回来放仓库整备的操作
但是这样没有解决在外探索背包满了，放到野外箱子之后，这些物资带回家的问题
可以安排快递（）

游戏初期玩家的基地是村庄中的老家，由于活动范围也在这个村庄里，所以上述问题不大
野外仓库不多，走几步就搬回来了
中期时设定玩家到处旅行，基地就变成了旅行的交通工具，这个交通工具和村庄里的老家其实没有区别，
人在哪个大区域，交通工具就在哪个区域，物品也就放在这里
但是脱离了村庄，旅行过程或者某些区域里，物品合成的工作台不完备，那么这些东西都得在交通工具上做
所以交通工具同时还有各种工作台的功能，那么在合成时，就得能检测仓库里的所有物品
初期的合成台得借用各个商店里的，所以只要判定玩家背包就行
后期时，交通工具的概念就不用了，玩家随意旅行，通过界心花的相关设定，玩家就彻底带着了老家

这么整理一下，好像也就是初期野外箱子要搬东西，中期工作台要检测全仓库这两点
貌似没有其他需要注意的了（）

还有另一个东西，是基地的仓库
单格物品无限堆叠，无限负重
仓库物品太多时，新物品进入背包就不知道在哪，如果是材料就可以不管，只要知道仓库里有多少数量即可，
找武器找消耗品时就会很混乱，需要有分类过滤功能，按照物品类型分类显示
分类完了还得有排序功能，数量排序，数值排序
武器因为有稀有度，可能会有一把武器占三四个位置的情况，这也得做好过滤

## 材料相关设定

游戏里所有系统和玩法
伐木、木雕
钓鱼、潜水
挖矿、考古
采集、探索
种地（未来计划里）
刷怪掉落，开启宝箱，完成事件

### 主要的材料产出方式

伐木，主要产出木材、树皮、叶子、植物果实
木雕，消耗木头得到工艺品，工艺品用来卖钱
钓鱼，产出水产食物、宝箱，垃圾
潜水，产出和钓鱼相同
挖矿，产出石头、矿物、泥土
考古，产出技能书，工艺品
采集，产出植物，叶子，植物果实，
探索，不直接产出物品，而是产出高爆率的地点，在对应地点采集产出更多
刷怪，根据敌人设定，产物大概是草木系列，石矿系列，毛皮

好原始的世界观设定。。。。

### 材料是要用的，目前想得到的几种材料系列的用法如下

木头系列
获得的自然材料是木屑、原木、树皮、树枝
加工一次才能获得的材料是木板
正常的合成是用原木做成木板，再由木板参与到装备武器合成，
树皮和树枝不是什么树的都有用，设定上这俩是稀有的
比如现实中，桂皮就是一种树皮，有用的就是桂树的皮，其他树没用
所以树皮和树枝就安排给一些特殊的树，树皮和树枝也不用加工木板，直接参与合成就行
比如星辰树法杖，要求星辰树的树枝，然后玩家可能通过各种方式得到星辰树原木，但是星辰树枝是珍贵的材料，要么找到星辰树获得，要么花费很高的代价获得

其中木屑是比较特别的材料，它最底层，大概就是垃圾
伐木的设定里，根据伐木的情况会产出木屑，原木加工时也会产出木屑
任何木屑可以合成，变成普通木板，
主要丢到炼金里填垃圾吧

毛皮系列
获得的自然材料是毛皮
加工一次才能得到的是皮革
用皮革合成兽皮装备
这其实不怎么算一个系列，就是需要过一遍加工逻辑而已
这个系列的垃圾是碎毛皮，开始想的是合成缝合皮革
那么这个缝合皮革能干嘛呢，好像加工一次之后也没啥用来着，给它安排一套防具？那感觉这个也太基础了，新手村送一套用用得了，后面也用不上
对于这种没想到用处的，一般是想丢炼金里，虽然说炼金的设定现在都没想出来呢

矿石系列
自然材料是矿石，宝石
加工材料是金属锭
用金属锭或者宝石合成武器装备
这个所谓系列也其实很敷衍
这里没想到有垃圾物品

鱼可以烤了吃
不明所以的东西都可以做药

好像没有想象中那么多系列
而且现在设想的东西都好原始啊，没有那种修仙玄幻的感觉
虽然可能就是换个名字，但是这个合成逻辑，如果全都通用，那还是感觉少了什么

## 物品合成设定

原料加工，将自然资源变成人工资源
锻造，将自然资源变成人工资源，主要针对矿石资源，没想好要不要做燃料啊暖机啊什么的设定
成品加工，将人造资源变成装备
烹饪，做食物的，食物主要用来回血，
炼丹，消耗药材，做成提供 buff 的丹药
药浴，消耗炼药的原料，获得永久的 buff
炼金术，垃圾桶合成系统

除了
药浴是把材料变成 buff，有点不一样
烹饪系统有直接煮熟，“制成干制品”，“浓缩成酱”、烹饪菜品的内部选择，也可以说不一样
其他的就真是换了个名字了

为了给消耗材料的生活技能搞点不一样的，也为游戏平衡与玩法，设定物品制作的条件
首先想做某个物品，它一定是有配方的
要是没有配方，程序都不知道应该怎么消耗材料，怎么提供经验
然后这个配方怎么获得呢

1：开局自带，

2：通过学习解锁，比如读书，比如完成什么事件

3：在其他游戏中有着让玩家选择几种材料，然后进行“推演”，如果选的材料正确，就能解锁对应的配方的玩法，比如“非生物因素”，

4：“我的世界”的合成与配方的方式

5：如果玩家拿到了某个合成后的成品，比如从哪里缴获的装备，开宝箱得到的药品之类的，玩家消耗一定数量的成品，允许反推它的配方，

6：根据玩家的材料图鉴解锁情况，自动获得点亮了 50%所需材料的配方
比如玩家第一次获得了原木，那些单纯用原木的配方就在这时候解锁，有些是原木+另一材料的配方，两种材料已经点亮了一个，达到了 50%，所以也解锁
第一次获得了石头，原木+石头+另一材料的配方此时就达到了 66%，就解锁

其中 125 是比较理想的获得配方的方式，34 不合适
6 这个，实际上是玩家在工作台面前的时候，工作台给玩家展示所有配方时可以做的
按照通常的游戏做法，玩家得到的所有配方，应该在工作台面前全部展示出来
如果是阶段性的升级，就展示当前阶段
如果是限定合成次数或者条件的，就仅在满足条件时展示，但也是全部展示
把需要的每种材料，每种材料的数量，合成的成品都展示给玩家
不过这里有个情况，是展示的东西是否会太多了呢，有些完全没有遇到过的材料却展示出来，
感觉还是复杂了，不想做

以 125 为主要解锁方式吧
其中，5 的解锁是虚假解锁，只能让玩家知道几种材料可以做到这个成品，至于材料分别是什么，要多少，得玩家得到过这个对应的材料才能知晓

物品合成的配方，上面要保存的信息：
原材料的种类和数量，
合成产物种类和数量，
合成必要工作台条件
5 方式解锁的配方，初始只有合成产物的种类和数量
而且得是主要产物，一个配方只能有一个主要产物，像是原木->木板+木屑的配方，就定义木板是主要产物，木屑不是
用木屑不能解锁配方
原材料和工作台得在图鉴里解锁过才能知道

回到一开始的问题，各种加工物品的生活技能，在游戏里实际上大部分是换皮的
这好吗，这不好，所以想做点文章
配方是所有加工物品的生活技能都要用的东西
里面有个要素是合成必要的工作台条件，这个可以做区分
原料加工，锻造，成品加工，烹饪，炼丹，药浴，炼金术
原料加工和成品加工，允许玩家随时随地进行，当然这些都是生活技能，战斗时不行
就是有些配方，它属于原料加工或者成品加工，并且没有要求工作台条件，所以就可以随地进行了
其他的配方都得要工作台环境，而工作台和地点绑定，这就给各个技能做出了区分
前期没有资源时，得去店里委托打造装备，后面有资源了，在家里造工作台，就能在家里制造了
可能玩家在家打造的工作台等级不如店里的，有些高级的还是得去店里造
这多少有点区分吧

原料加工的工作台叫制革工作台，木匠工作台
锻造的叫熔炉、铁匠工作台，
成品加工的叫工作台
其实原料加工和成品加工不用分的那么清楚，有些装备就在木匠工作台里做也没什么
烹饪的显然叫厨房
炼丹的叫炼丹炉
药浴叫药浴室
炼金术叫炼金车间

开始时有小巧思，想把材料按系列分类，然后工作台也按系列分类，后来发现这个分类多少有点形式，实际游玩可能不如单纯给一个工作台

## 稀有掉落设定

需要为游戏中的稀有游戏内容设定保底，包括且不限于
某地刷怪时刷新出现稀有怪
击败敌人产生掉落物时掉落该敌人的稀有产物
开宝箱时获得其中稀有的物品
探索时探到稀有的地点
有随机效果的招式触发好效果
等等

保底分为次数保底和时间保底

目前随机这些东西有两套算法
一是权重随机，比如地点里有 n 个怪，每个怪都有自己的权重
在 0 到所有权重累加之间产生一个随机数，命中了哪一个怪的权重，这次就刷它

二是数值随机，比如打一个怪有 20%的概率掉东西
在 0 到 100 之间产生一个随机数，随机数在 0-20 之间就算成功

两种随机算法经常嵌套，比如先用数值随机决定次数，再进行 n 次权重随机得到刷新的目标，再进行数值随机得到刷新的数量
所以保底就不能在原有的这些算法内部加东西了
只能是根据随机完毕的结果进行保底
每次随机完毕之后进入保底逻辑

### 次数保底

次数保底的逻辑：
针对稀有的对象，从刷新的环境里计算出一次刷新命中它的概率
将概率换算成期望次数
如果当次正常随机没有产生稀有对象，则累计一次保底次数
保底概率为期望概率\*保底次数/（期望次数/2）
然后用保底概率进行一次数值随机
正常随机或保底随机命中，保底次数归零
如果保底次数大于等于期望次数，则当次必定命中

期望掉率 1%
期望次数 100

| 尝试次数 | 无保底概率 | 保底概率 | 保底没命中概率 | 至少保底一次概率 | 总出货概率 |
| -------- | ---------- | -------- | -------------- | ---------------- | ---------- |
| 1        | 1.00%      | 0.02%    | 99.98%         | 0.02%            | 1.02%      |
| 5        | 4.90%      | 0.10%    | 99.90%         | 0.50%            | 5.38%      |
| 10       | 9.56%      | 0.20%    | 99.80%         | 1.98%            | 11.35%     |
| 15       | 13.99%     | 0.30%    | 99.70%         | 4.41%            | 17.78%     |
| 20       | 18.21%     | 0.40%    | 99.60%         | 7.70%            | 24.51%     |
| 25       | 22.22%     | 0.50%    | 99.50%         | 11.78%           | 31.38%     |
| 30       | 26.03%     | 0.60%    | 99.40%         | 16.52%           | 38.25%     |
| 35       | 29.66%     | 0.70%    | 99.30%         | 21.80%           | 44.99%     |
| 40       | 33.10%     | 0.80%    | 99.20%         | 27.48%           | 51.49%     |
| 45       | 36.38%     | 0.90%    | 99.10%         | 33.42%           | 57.65%     |
| 50       | 39.50%     | 1.00%    | 99.00%         | 39.50%           | 63.40%     |
| 55       | 42.46%     | 1.10%    | 98.90%         | 45.58%           | 68.69%     |
| 60       | 45.28%     | 1.20%    | 98.80%         | 51.54%           | 73.48%     |
| 65       | 47.97%     | 1.30%    | 98.70%         | 57.28%           | 77.77%     |
| 70       | 50.52%     | 1.40%    | 98.60%         | 62.73%           | 81.56%     |
| 75       | 52.94%     | 1.50%    | 98.50%         | 67.81%           | 84.85%     |
| 80       | 55.25%     | 1.60%    | 98.40%         | 72.48%           | 87.69%     |
| 85       | 57.44%     | 1.70%    | 98.30%         | 76.72%           | 90.09%     |
| 90       | 59.53%     | 1.80%    | 98.20%         | 80.50%           | 92.11%     |
| 95       | 61.51%     | 1.90%    | 98.10%         | 83.84%           | 93.78%     |
| 100      | 63.40%     | 2.00%    | 98.00%         | 86.74%           | 95.15%     |
| 105      | 65.19%     | 2.10%    | 97.90%         | 89.23%           | 96.25%     |
| 110      | 66.90%     | 2.20%    | 97.80%         | 91.34%           | 97.13%     |
| 115      | 68.52%     | 2.30%    | 97.70%         | 93.12%           | 97.83%     |
| 120      | 70.06%     | 2.40%    | 97.60%         | 94.58%           | 98.38%     |
| 125      | 71.53%     | 2.50%    | 97.50%         | 95.78%           | 98.80%     |

可以看到，常规数值随机的情况下，1%概率期望 100 次出货，实际上 100 次时出货一次的概率只有 63%，
而加上保底之后，100 次时出货一次的概率达到了 95%
再加上 100 次不出时的硬保底，掉落率这块肯定能让玩家满意，95%的中途掉落概率也应该能让玩家察觉不到保底的存在吧

### 时间保底

暂时没想到这种东西应该怎么做

### 保底适用对象

以上的保底机制理论上应该只给稀有的物品用，实际上由于有权重随机的机制，有些东西没有明面上的概率，可能也没定义稀有与否
为了通用，将要定义什么东西是稀有的

首先不能绝对的定义某些东西就是稀有的
因为 A 物品可能在 a 地点稀有，需要遵守保底机制，但是到了后期的 b 地点，就是随意掉落的不稀有的了

掉落列表中的多个对象，应该给对象设置一个表示“是否稀有”的标记，
比如伐木地点刷新树木，某些树是稀有树，一定时间内只会刷新数个，所以需要特别标记他们是稀有的
此时，检测每个对象，定义了稀有标记的直接当作稀有物品进行处理

掉落列表多个对象如果没有稀有标记，
那这种时候常常用的是权重随机，此时计算每个对象的期望概率，低于 5%的对象视作稀有对象，比如通往外层森林的道路，这里会遇到早期的野怪，安排了一个野猪，不算多么珍贵的生物，这里也没定义稀有标记，但是野猪的期望概率低于 5%，就应该处理

数值随机的事件，如果概率低于 5%，应该处理
比如打死了敌人要掉物品，敌人的掉率低于 5%就需要进行保底处理，不过可能不怎么会设计这种敌人吧，我可能会设计一个 100%掉东西的敌人，然后在它的掉落列表里安排许多垃圾，其中就有稀有掉落，权重比较低
